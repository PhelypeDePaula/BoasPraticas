import { test, expect } from '@playwright/test';

test('Acessar o Google e realizar busca', async ({ page }) => {
  try {
    // Navegar para o site do Google
    await page.goto('https://www.google.com');

    // Aceitar cookies, caso apareça o botão
    const acceptCookiesButton = page.locator('button:has-text("Aceitar tudo")');
    if (await acceptCookiesButton.isVisible()) {
      await acceptCookiesButton.click();
    }

    // Fechar o pop-up de login, caso apareça
    const closeLoginPopupButton = page.getByRole('button', { name: 'Não conectar' });
    if (await closeLoginPopupButton.isVisible()) {
      await closeLoginPopupButton.click();
    }

    // Garantir que o campo de busca está visível antes de interagir
    const searchInput = page.getByRole('combobox', { name: 'Pesquisar' });
    await searchInput.waitFor({ state: 'visible' });

    // Digitar "rar" na barra de pesquisa e pressionar Enter
    await searchInput.fill('rar');
    await searchInput.press('Enter');

    // Tirar um print da tela após a busca
    await page.screenshot({ path: 'screenshot-final.png' });

    console.log('Teste concluído com sucesso!');
  } catch (error) {
    console.error('Erro durante o teste:', error);
  }
});